# 快速开始指南

## 1. 快速启动（推荐）

```bash
# 进入项目目录
cd masterthesis-data

# 运行启动脚本
./start.sh
```

## 2. 手动启动

```bash
# 安装依赖（如果还未安装）
pip3 install PyQt5 matplotlib pandas numpy openpyxl

# 启动程序
python3 main.py
```

## 3. 基本使用流程

### 第一步：加载数据
1. 点击 `Select Excel File` 按钮
2. 选择您的Excel数据文件
3. 程序会自动分析列名

### 第二步：选择数据列
1. 在列表中选择要绘制的数据列（使用Ctrl+点击多选）
2. 选择时间列
3. 可以点击 `Auto-Match Pairs` 自动匹配湿度-压力对

### 第三步：配置设置（可选）
- **时间范围**：选择显示全部数据、前2小时或自定义范围
- **校准功能**：勾选"Enable Moisture Calibration"并配置参数
- **差值分析**：勾选相应选项进行差值计算

### 第四步：生成图表
点击 `Generate Chart` 按钮，程序将在新窗口中显示图表

### 第五步：导出数据（可选）
点击 `Export Data` 按钮将处理后的数据导出为Excel文件

## 4. 重要功能说明

### 🔧 湿度校准
- 配置湿度-压力对后，程序会使用校准公式修正数据
- 校准公式：`ppm_calibrated = concentration × (p_ref/p)^(f1·ln(p_ref/p)+f2)`
- 默认参数：f1=0.196798, f2=0.419073, p_ref=1.0

### 📊 图表功能
- 原始数据显示为实线
- 校准后数据显示为虚线加标记
- 支持保存图表和复制到剪贴板
- 可显示误差范围

### 💾 配置保存
- 程序会自动保存最近使用的配置
- 下次打开相同文件时会自动加载配置
- 可以手动保存/加载配对配置和校准参数

## 5. 示例数据格式

您的Excel文件应包含类似以下结构：

| Time | H2O_Sensor1 | Pressure1 | H2O_Sensor2 | Pressure2 |
|------|-------------|-----------|-------------|-----------|
| 2024-01-01 10:00:00 | 25.3 | 1.013 | 24.8 | 1.015 |
| 2024-01-01 10:01:00 | 25.5 | 1.012 | 24.9 | 1.014 |
| ... | ... | ... | ... | ... |

## 6. 常见问题解决

**Q: 程序无法启动？**
A: 确保Python 3.7+已安装，运行 `./start.sh` 自动安装依赖

**Q: 图表不显示？**  
A: 检查是否选择了数据列和时间列

**Q: 校准功能不工作？**
A: 确保勾选了"Enable Moisture Calibration"并正确配置了湿度-压力对

**Q: 自动匹配不准确？**
A: 手动选择列后点击对应的"Set"按钮设置配对

## 7. 获取帮助

查看完整文档：`README.md`

---

🎉 现在您可以开始使用H2O数据可视化和校准工具了！ 